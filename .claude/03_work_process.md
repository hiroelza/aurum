# 作業プロセスとガイドライン

このファイルは、aurumプロジェクトでの作業プロセスと標準的なガイドラインを定義します。

---

## 作業開始前の原則 🔴 CRITICAL

### ルールファイルを必ず読む

すべての作業開始前に、以下を徹底してください：

**❌ やってはいけないこと:**
- 「だいたいこんな感じだろう」と記憶に頼る
- 過去の作業パターンを盲目的に繰り返す
- ルールファイルを読まずに作業を開始する

**✅ 必ずやること:**
1. **`.claude/00_work_checklist.md`を読む**
   - 作業内容に応じた確認事項を確認
   - 関連するルールファイルへの参照を確認

2. **関連するルールファイルを読む**
   - ファイル配置が必要なら → `.claude/02_directory_structure.md`
   - 投資判断なら → `.claude/01_project_overview.md`
   - Python実行なら → `.claude/04_python_guide.md`

3. **疑問があれば再度ドキュメントを確認**
   - 「たぶん合ってる」で進めない
   - 不明点はドキュメントで確認

### なぜこの原則が重要か

**2025年11月9日の教訓:**
- ディレクトリ配置ルールが`.claude/02_directory_structure.md`に明記されていた
- しかし、作業開始時に読まずに「記憶」に頼って配置した
- 結果: `outputs/reports/working/20251109_.../`を作成（月ディレクトリ`202511/`が欠落）
- 正しくは: `outputs/reports/working/202511/20251109_.../`

**教訓:**
- **急がば回れ** - 事前確認を最優先する
- **ルールは読むために存在する** - 記憶に頼らない
- **チェックリストで確実に確認** - ミスを防ぐ仕組み

---

## 基本プロセス（4段階）

すべての作業は以下の4段階を踏んでください：

```
1. 要件定義 → 2. 要件詳細 → 3. TODOリスト作成 → 4. TODOリスト実行
```

### 1. 要件定義

**目的:** 何を実現するかを明確化

**実施内容:**
- 作業の目的を明文化
- 期待される成果物を定義
- 制約条件・前提条件の確認

**重要:**
- **必ずPlan Mode（Planning Mode）で実施**
- いきなり実行せず、必ず内容確認を経る
- ファイル出力: `outputs/reports/working/yyyymmdd/要件定義_[タスク名].md`

### 2. 要件詳細

**目的:** 実装方法を具体化

**実施内容:**
- データソースの特定
- 使用するツール・スクリプトの選定
- 処理フローの設計
- 出力フォーマットの定義

**ファイル出力:** `outputs/reports/working/yyyymmdd/要件詳細_[タスク名].md`

### 3. TODOリスト作成

**目的:** 作業を分解してタスク化

**実施内容:**
- 実装手順を具体的なタスクに分解
- 各タスクの優先順位付け
- 所要時間の見積もり

**ツール使用方針（ハイブリッド方式）:**

このプロジェクトでは、以下のハイブリッド方式を採用します：

#### セッション中：TodoWriteツールで動的管理

- **使用ツール**: Claude Codeの`TodoWrite`ツール
- **目的**: リアルタイムな進捗表示、ユーザーへの可視性向上
- **運用**:
  - タスク開始時に`TodoWrite`でタスクリストを作成
  - 作業進行に応じて`status`を更新（`pending` → `in_progress` → `completed`）
  - ユーザーはClaude Codeインターフェース上で進捗を確認可能

#### セッション終了時：必ずファイル出力

- **ファイル出力先**: `outputs/reports/working/yyyymmdd/TODO_[タスク名].md`
- **目的**: Git履歴管理、トレーサビリティ確保、複数セッション対応
- **運用**:
  - セッション完了時、`TodoWrite`の内容をMarkdownファイルとして出力
  - 未完了タスクがある場合も、現状をファイル保存
  - 次回セッション時はこのファイルから再開

#### ハイブリッド方式の利点

1. **リアルタイム性**: セッション中はツールで動的に進捗管理
2. **永続性**: セッション終了後もGit履歴で追跡可能
3. **トレーサビリティ**: すべての判断根拠がファイルで保存
4. **複数セッション対応**: 中断・再開が容易

#### ファイル出力フォーマット例

```markdown
# TODO: [タスク名]

作成日時: YYYY-MM-DD HH:MM
最終更新: YYYY-MM-DD HH:MM

## タスクリスト

- [x] タスク1: 完了した内容
- [ ] タスク2: 未完了の内容
- [ ] タスク3: 未着手の内容

## メモ・気づき

- タスク実行中の気づきやメモを記録
```

### 4. TODOリスト実行

**実施内容:**
- TODOリストに従って順次実行
- 進捗を随時更新（`[x]`でマーク）
- 完了したタスクは記録を残す

**重要:**
- 実行中のメモや気づきも同じディレクトリに記録
- 問題が発生したら要件定義・詳細に戻って見直す

---

## 📚 詳細ドキュメント

このファイルは基本プロセスの概要を提供します。詳細は以下のファイルを参照してください：

### プロセス省略ルール（Level 1-4）
→ **[03a_work_levels.md](03a_work_levels.md)** を参照

作業の複雑さに応じてプロセスを省略可能：
- **Level 1**: 極めて簡単（5分以内）→ 全プロセス省略
- **Level 2**: 簡単（30分以内）→ Plan Modeのみ
- **Level 3**: 中程度（1-2時間）→ 要件定義+TODO必須
- **Level 4**: 複雑（2時間以上）→ 全プロセス必須

### プロジェクト管理ワークフロー（temp_n）
→ **[03b_project_workflow.md](03b_project_workflow.md)** を参照

temp_n命名規則と自動昇格：
- **Phase 1**: 軽量スタート（temp_1.md）
- **Phase 2**: 自動ディレクトリ化（temp_1/）
- **Phase 3**: 完了とリネーム（yyyymmdd_テーマ/）

### サブエージェント議論フレームワーク
→ **[03c_agent_discussion.md](03c_agent_discussion.md)** を参照

複数視点からの評価が必要な場合の議論プロセス：
- **Phase 1**: 共有（Share）
- **Phase 2**: 発散（Diverge）
- **Phase 3**: 収束（Converge）
- **Phase 4**: 決定（Decide）

---

---

## 冪等性の確保

**原則:** 作業の各段階を必ずファイル出力する

**理由:**
- 作業を再現可能にする
- 中断・再開が容易になる
- 過去の判断根拠を追跡できる
- 複数セッションにまたがる作業を管理しやすい

**詳細:**
- プロセス省略ルール → [03a_work_levels.md](03a_work_levels.md)
- プロジェクト管理ワークフロー → [03b_project_workflow.md](03b_project_workflow.md)
- 議論フレームワーク → [03c_agent_discussion.md](03c_agent_discussion.md)

---

**最終更新**: 2025年11月9日（Phase 10: 詳細を分割ファイルに移行）
