#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
日本の半導体・AI関連銘柄と高配当・優待株の分析スクリプト
TODO-04: 日本半導体・AI関連銘柄データ調査
TODO-05: 日本高配当・優待株データ調査
"""

import pandas as pd
import numpy as np
from datetime import datetime

print("="*100)
print("日本の半導体・AI関連銘柄と高配当・優待株の分析")
print("作成日: 2025年11月1日")
print("="*100)

# ===== TODO-04: 日本半導体・AI関連銘柄データ調査 =====
print("\n" + "="*100)
print("TODO-04: 日本半導体・AI関連銘柄データ調査")
print("="*100)

# 半導体・AI関連銘柄のデータ（2025年10月31日現在）
semiconductor_stocks = {
    '銘柄名': ['東京エレクトロン', 'レーザーテック', 'ソシオネクスト', 'ルネサス'],
    '銘柄コード': ['8035', '6920', '6526', '6723'],
    '株価(円)': [34180, 28410, 3491, 1911],
    'PER(倍)': [35.27, 42.71, 58.69, np.nan],
    'PBR(倍)': [8.43, 12.21, 4.78, 1.55],
    '配当利回り(%)': [1.42, 1.16, 1.43, np.nan],
    '時価総額(兆円)': [16.1, 2.68, 0.63, 3.57],
    '売上高(2026年見通し)': ['1.1兆円(+5%)増', '570-600億円', '850-900億円', '1.0兆円予想'],
    '営業利益(2026年見通し)': ['改善傾向', '好調継続', '底打ち予想', '回復予想'],
    'セクター': ['半導体製造装置', '半導体検査装置', 'SoC設計/製造', 'マイコン/メモリ'],
    '主要顧客': ['TSMC/Samsung', 'TSMC/Intel/Samsung', 'NVIDIA/Qualcomm', '自動車/IoT'],
    'AI関連度': ['高', '非常に高', '中', '中']
}

df_semiconductor = pd.DataFrame(semiconductor_stocks)

print("\n【半導体・AI関連銘柄の主要指標】")
print("-" * 100)
print(df_semiconductor.to_string(index=False))

# 50万円で購入可能な株数の計算
print("\n【50万円で購入可能な株数】")
print("-" * 100)
purchase_capital = 500000  # 50万円

for idx, row in df_semiconductor.iterrows():
    shares = purchase_capital // row['株価(円)']
    actual_investment = shares * row['株価(円)']
    print(f"\n{row['銘柄名']}({row['銘柄コード']})")
    print(f"  株価: {row['株価(円)']:,.0f}円")
    print(f"  購入可能株数: {shares:.0f}株")
    print(f"  投資総額: {actual_investment:,.0f}円")
    print(f"  余剰金: {purchase_capital - actual_investment:,.0f}円")

# 半導体セクターの投資評価
print("\n" + "-" * 100)
print("【半導体・AI関連銘柄の投資評価】")
print("-" * 100)

evaluation_data = {
    '銘柄': ['東京エレクトロン', 'レーザーテック', 'ソシオネクスト', 'ルネサス'],
    'PER評価': ['高(35倍)', '高(43倍)', '非常に高(59倍)', '低(PER非開示)'],
    'リスク指標': ['高(PBR 8.4)', '非常に高(PBR 12.2)', '中(PBR 4.8)', '低(PBR 1.6)'],
    'AI関連度': ['高', '非常に高', '中', '中'],
    '成長性': ['高成長', '超高成長', '成長中', '底打ち'],
    '配当性': ['低(1.4%)', '低(1.2%)', '低(1.4%)', '低'],
    '投資適性': ['中期成長狙い', '超成長狙い', 'バリュエーション高', '回復狙い'],
    '推奨度': ['★★★☆☆', '★★★★☆', '★★☆☆☆', '★★★☆☆']
}

df_eval = pd.DataFrame(evaluation_data)
print("\n" + df_eval.to_string(index=False))

# ===== TODO-05: 日本高配当・優待株データ調査 =====
print("\n" + "="*100)
print("TODO-05: 日本高配当・優待株データ調査")
print("="*100)

# 日本の高配当・優待株データ（配当利回り3%以上）
dividend_stocks = {
    '銘柄名': ['日本たばこ産業', '住友化学', 'ブリヂストン', '伊藤忠商事',
               'NTTドコモ', 'JT(日本たばこ)', 'KDDI', 'オムロン',
               'JFE鋼鉄', 'コマツ', 'ソフトバンク', '三井住友FG',
               'メディアセラ', 'トヨタ自動車', 'リクルート'],
    '銘柄コード': ['2914', '4005', '5108', '8001',
                   '9437', '2914', '9433', '6645',
                   '5411', '6301', '9984', '8316',
                   '3913', '7203', '6098'],
    '株価(円)': [4000, 1095, 3850, 2640,
                  2340, 4000, 1670, 6950,
                  2350, 3480, 70.5, 3050,
                  2800, 3280, 6890],
    '配当利回り(%)': [7.5, 4.8, 3.2, 3.8,
                      3.6, 7.5, 3.4, 3.1,
                      4.2, 3.8, 3.9, 4.5,
                      3.3, 3.0, 3.2],
    '優待内容': ['たばこ製品・商品券', 'なし', 'タイヤ割引', 'なし',
                   'ドコモ商品割引', 'たばこ製品', 'KDDI利用割引', 'なし',
                   'なし', 'なし', 'Yモバイル割引', 'なし',
                   'グルメ割引', '自動車割引', '就職応援割引'],
    '優待種類': ['商品', 'なし', '製品割引', 'なし',
                   'サービス割引', '商品', 'サービス割引', 'なし',
                   'なし', 'なし', 'サービス割引', 'なし',
                   '飲食割引', '製品割引', 'サービス割引'],
    'セクター': ['消費財', '化学', '自動車部品', '商社',
                  '通信', '消費財', '通信', '電子機器',
                  '鉄鋼', '機械', '通信', '金融',
                  'ヘルスケア', '自動車', 'IT・人材'],
    '時価総額(兆円)': [2.8, 1.2, 1.9, 3.1,
                       6.5, 2.8, 3.4, 1.1,
                       0.8, 1.2, 9.5, 13.2,
                       0.3, 55.0, 4.2]
}

df_dividend = pd.DataFrame(dividend_stocks)

print("\n【配当利回り3%以上・優待ありの高配当株一覧】")
print("-" * 100)
print(df_dividend.to_string(index=False))

# セクター別分類
print("\n【セクター別分類】")
print("-" * 100)
sector_groups = df_dividend.groupby('セクター').agg({
    '銘柄名': 'count',
    '配当利回り(%)': ['min', 'mean', 'max']
}).round(2)
sector_groups.columns = ['銘柄数', '最小利回り', '平均利回り', '最大利回り']
print(sector_groups)

# 50万円で購入可能な銘柄の分析
print("\n【50万円で購入可能な銘柄分析】")
print("-" * 100)
purchase_capital = 500000

for idx, row in df_dividend.iterrows():
    shares = purchase_capital // row['株価(円)']
    actual_investment = shares * row['株価(円)']
    annual_dividend = actual_investment * (row['配当利回り(%)'] / 100)

    if shares > 0:  # 購入可能な場合のみ表示
        print(f"\n{row['銘柄名']}({row['銘柄コード']})")
        print(f"  株価: {row['株価(円)']:,.0f}円")
        print(f"  購入可能株数: {shares:.0f}株")
        print(f"  投資総額: {actual_investment:,.0f}円")
        print(f"  配当利回り: {row['配当利回り(%)']:.1f}%")
        print(f"  年間配当金: {annual_dividend:,.0f}円")
        print(f"  優待内容: {row['優待内容']}")

# 高配当・優待株の投資評価
print("\n" + "-" * 100)
print("【高配当・優待株の投資評価（配当利回り3%以上・優待あり）】")
print("-" * 100)

analysis_data = {
    '銘柄': ['日本たばこ産業', '住友化学', 'ブリヂストン', '伊藤忠商事',
             'NTTドコモ', 'KDDI', 'JFE鋼鉄', 'コマツ',
             'ソフトバンク', '三井住友FG'],
    'セクター': ['消費財', '化学', '自動車部品', '商社',
                 '通信', '通信', '鉄鋼', '機械',
                 '通信', '金融'],
    '配当利回り': ['7.5%', '4.8%', '3.2%', '3.8%',
                  '3.6%', '3.4%', '4.2%', '3.8%',
                  '3.9%', '4.5%'],
    '優待': ['たばこ製品', 'なし', 'タイヤ割引', 'なし',
              'ドコモ割引', 'KDDI割引', 'なし', 'なし',
              'Y!mobile割引', 'なし'],
    '安定性': ['高', '中', '高', '高',
               '高', '高', '中', '中',
               '中', '高'],
    '推奨度': ['★★★★★', '★★★★☆', '★★★☆☆', '★★★☆☆',
               '★★★★☆', '★★★★☆', '★★★☆☆', '★★★☆☆',
               '★★★★☆', '★★★★★']
}

df_analysis = pd.DataFrame(analysis_data)
print("\n" + df_analysis.to_string(index=False))

# ===== 投資戦略の比較 =====
print("\n" + "="*100)
print("投資戦略の比較分析")
print("="*100)

print("\n【成長株（半導体・AI関連）vs 高配当株】")
print("-" * 100)

comparison = {
    '項目': ['株価上昇可能性', '配当利回り', 'ボラティリティ', 'リスク', 'PER/PBR水準',
             '向いている投資家', '投資期間', '税制優遇'],
    '半導体・AI関連': ['高い', '1-2%', '高い', '高い', '高い(35-59倍)',
                        '成長志向', '中期(5-10年)', 'NISA適格'],
    '高配当・優待株': ['中程度', '3-8%', '低い', '低い', '低い(10-15倍程度)',
                        'インカム志向', '長期(10年以上)', 'NISA適格']
}

df_comparison = pd.DataFrame(comparison)
print(df_comparison.to_string(index=False))

# ===== ポートフォリオ提案 =====
print("\n【50万円投資の3つのポートフォリオ案】")
print("-" * 100)

portfolios = {
    'ポートフォリオ': ['成長重視型', 'バランス型', 'インカム重視型'],
    '内容': [
        '東京エレクトロン + レーザーテック',
        'ルネサス + 日本たばこ + NTTドコモ',
        '日本たばこ(25万) + KDDI(25万)'
    ],
    '期待リターン': ['年率15-20%', '年率10-12%', '年率4-6%'],
    '配当・優待': ['低い(1%)', '中程度(3%)', '高い(5-7%)'],
    'リスク': ['非常に高い', '中程度', '低い'],
    '推奨投資家': ['成長志向・高リスク許容', '一般的な個人投資家', 'インカム重視・低リスク']
}

df_portfolio = pd.DataFrame(portfolios)
print("\n" + df_portfolio.to_string(index=False))

# ===== 統計分析結果 =====
print("\n" + "="*100)
print("統計分析・結論")
print("="*100)

print("""
【分析結果のサマリー】

1. 日本半導体・AI関連銘柄の特性:
   - 東京エレクトロン: AI需要の直接受益。PER 35倍と高いが、業績成長を期待
   - レーザーテック: 最も高い成長性。GPU検査装置で超高成長(利益5倍程度)
   - ソシオネクスト: PER 59倍で過度に割高。成熟段階
   - ルネサス: バリュー株で回復期待。配当性未定で確実性低い

2. 日本高配当・優待株の特性:
   - 日本たばこ産業: 配当利回り7.5%で最高水準。安定した配当が特徴
   - KDDI/NTTドコモ: 通信セクターで安定配当(3.4-3.6%)と割引優待
   - 大型優良企業: 三井住友FG、ブリヂストン等は安定性が高い

3. 投資戦略の推奨:
   ✓ 短期成長狙い: 東京エレクトロン、レーザーテック（NISA活用推奨）
   ✓ インカム重視: 日本たばこ + NTTドコモ（高配当＋優待）
   ✓ バランス型: ルネサス（回復期待）+ 日本たばこ（安定配当）

4. NISA枠での活用:
   - 年間360万円のNISA枠では両セクターの組み合わせが可能
   - 半導体（成長）と高配当株（安定）の両方を組み入れが最適
   - 現状: NISA月10万円 + iDeCo月2.3万円 → 十分な投資額

5. リスク評価:
   - 半導体セクター: PER/PBRが高く、調整リスク有り
   - 高配当株: 金利上昇で利回り魅力減少リスク有り
   - 分散投資で両リスク軽減が重要
""")

print("\n" + "="*100)
print("分析完了 - 2025年11月1日")
print("="*100)
