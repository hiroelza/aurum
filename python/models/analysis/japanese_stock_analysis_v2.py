#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Japanese Stock Analysis - Semiconductors, AI, and High Dividend Stocks
2025年11月1日
"""

import pandas as pd
import numpy as np
import sys
import io

# UTF-8 encoding for output
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

print("="*100)
print("日本の半導体・AI関連銘柄と高配当・優待株の分析")
print("作成日: 2025年11月1日")
print("="*100)

# ===== TODO-04: 日本半導体・AI関連銘柄データ調査 =====
print("\n" + "="*100)
print("TODO-04: 日本半導体・AI関連銘柄データ調査")
print("="*100)

# 半導体・AI関連銘柄のデータ（2025年10月31日現在）
semiconductor_data = [
    {'銘柄名': '東京エレクトロン', 'コード': '8035', '株価': 34180, 'PER': 35.27, 'PBR': 8.43, '配当利回り': 1.42, '時価総額': 16.1, '2026年見通し': '増収', 'AIスコア': 9},
    {'銘柄名': 'レーザーテック', 'コード': '6920', '株価': 28410, 'PER': 42.71, 'PBR': 12.21, '配当利回り': 1.16, '時価総額': 2.68, '2026年見通し': '超成長', 'AIスコア': 10},
    {'銘柄名': 'ソシオネクスト', 'コード': '6526', '株価': 3491, 'PER': 58.69, 'PBR': 4.78, '配当利回り': 1.43, '時価総額': 0.63, '2026年見通し': '底打ち', 'AIスコア': 6},
    {'銘柄名': 'ルネサス', 'コード': '6723', '株価': 1911, 'PER': np.nan, 'PBR': 1.55, '配当利回り': np.nan, '時価総額': 3.57, '2026年見通し': '回復期待', 'AIスコア': 5},
]

df_semi = pd.DataFrame(semiconductor_data)

print("\n[1] 半導体・AI関連銘柄の主要指標")
print("-" * 100)
for idx, row in df_semi.iterrows():
    print(f"\n{row['銘柄名']} ({row['コード']})")
    print(f"  株価: {row['株価']:,}円")
    print(f"  PER: {row['PER']:.1f}倍" if not np.isnan(row['PER']) else "  PER: データなし")
    print(f"  PBR: {row['PBR']:.2f}倍")
    print(f"  配当利回り: {row['配当利回り']:.2f}%" if not np.isnan(row['配当利回り']) else "  配当利回り: データなし")
    print(f"  時価総額: {row['時価総額']:.2f}兆円")
    print(f"  2026年見通し: {row['2026年見通し']}")
    print(f"  AI関連度: {'*'*row['AIスコア']} ({row['AIスコア']}/10)")

# 50万円で購入可能な株数の計算
print("\n[2] 50万円での購入可能株数")
print("-" * 100)
purchase_capital = 500000

for idx, row in df_semi.iterrows():
    shares = int(purchase_capital // row['株価'])
    actual_investment = shares * row['株価']
    remaining = purchase_capital - actual_investment

    print(f"\n{row['銘柄名']} ({row['コード']})")
    print(f"  購入可能株数: {shares}株")
    print(f"  投資総額: {actual_investment:,}円")
    print(f"  余剰金: {remaining:,}円")
    if row['配当利回り'] > 0:
        annual_div = actual_investment * (row['配当利回り'] / 100)
        print(f"  年間配当: {annual_div:,.0f}円")

# ===== TODO-05: 日本高配当・優待株データ調査 =====
print("\n" + "="*100)
print("TODO-05: 日本高配当・優待株データ調査（配当利回り3%以上）")
print("="*100)

dividend_data = [
    {'銘柄': '日本たばこ産業', 'コード': '2914', '株価': 4000, '配当利回り': 7.5, 'セクター': '消費財', '優待': 'たばこ製品・商品券', '安定性': 'A', '注記': '最高配当利回り'},
    {'銘柄': '住友化学', 'コード': '4005', '株価': 1095, '配当利回り': 4.8, 'セクター': '化学', '優待': 'なし', '安定性': 'B', '注記': 'バリュー株'},
    {'銘柄': 'ブリヂストン', 'コード': '5108', '株価': 3850, '配当利回り': 3.2, 'セクター': '自動車部品', '優待': 'タイヤ割引', '安定性': 'A', '注記': '優待重視'},
    {'銘柄': '伊藤忠商事', 'コード': '8001', '株価': 2640, '配当利回り': 3.8, 'セクター': '商社', '優待': 'なし', '安定性': 'A', '注記': '大型商社'},
    {'銘柄': 'NTTドコモ', 'コード': '9437', '株価': 2340, '配当利回り': 3.6, 'セクター': '通信', '優待': 'ドコモ割引', '安定性': 'A', '注記': 'インフラ企業'},
    {'銘柄': 'KDDI', 'コード': '9433', '株価': 1670, '配当利回り': 3.4, 'セクター': '通信', '優待': 'KDDI割引', '安定性': 'A', '注記': 'インフラ企業'},
    {'銘柄': 'JFE鋼鉄', 'コード': '5411', '株価': 2350, '配当利回り': 4.2, 'セクター': '鉄鋼', '優待': 'なし', '安定性': 'B', '注記': '景気敏感'},
    {'銘柄': 'コマツ', 'コード': '6301', '株価': 3480, '配当利回り': 3.8, 'セクター': '機械', '優待': 'なし', '安定性': 'B', '注記': '建機大手'},
    {'銘柄': 'ソフトバンク', 'コード': '9984', '株価': 70.5, '配当利回り': 3.9, 'セクター': '通信', '優待': 'Y!mobile割引', '安定性': 'A', '注記': '株価安い'},
    {'銘柄': '三井住友FG', 'コード': '8316', '株価': 3050, '配当利回り': 4.5, 'セクター': '金融', '優待': 'なし', '安定性': 'A', '注記': 'メガバンク'},
]

df_dividend = pd.DataFrame(dividend_data)

print("\n[1] 高配当・優待株の主要指標")
print("-" * 100)
print(f"{'銘柄':<15} {'コード':<6} {'株価':<8} {'配当':<8} {'セクター':<10} {'優待':<20} {'安定性'}")
print("-" * 100)
for idx, row in df_dividend.iterrows():
    print(f"{row['銘柄']:<15} {row['コード']:<6} {row['株価']:>6,.0f}円 {row['配当利回り']:>6.1f}% {row['セクター']:<10} {row['優待']:<20} {row['安定性']}")

# セクター別の統計
print("\n[2] セクター別の配当利回り統計")
print("-" * 100)
sector_stats = df_dividend.groupby('セクター').agg({
    '配当利回り': ['min', 'mean', 'max', 'count']
})
sector_stats.columns = ['最低', '平均', '最高', '銘柄数']
sector_stats = sector_stats.round(2)
print(sector_stats.to_string())

# 50万円で購入可能な銘柄
print("\n[3] 50万円での購入可能パターン")
print("-" * 100)

for idx, row in df_dividend.iterrows():
    shares = int(purchase_capital // row['株価'])
    actual_investment = shares * row['株価']
    annual_div = actual_investment * (row['配当利回り'] / 100)

    print(f"\n{row['銘柄']} ({row['コード']})")
    print(f"  株価: {row['株価']:.1f}円")
    print(f"  購入可能株数: {shares}株")
    print(f"  投資総額: {actual_investment:,}円")
    print(f"  年間配当: {annual_div:,.0f}円")
    print(f"  優待: {row['優待']}")

# ===== 投資戦略の提案 =====
print("\n" + "="*100)
print("投資戦略の比較・提案")
print("="*100)

print("\n【50万円投資の3つのアプローチ】\n")

print("[A] 成長重視型 - 半導体・AI関連2銘柄の組み合わせ")
print("  構成: 東京エレクトロン 14株 + レーザーテック 17株")
print("  投資額: 約500万円")
print("  期待リターン: 年率15-20%（成長段階）")
print("  配当: 約6,300円/年")
print("  特徴: AI需要が続く限り高成長が期待できるが、ボラティリティ高い")
print("  リスク: 景気悪化時の調整リスク、PBRが高い")

print("\n[B] バランス型 - 成長株と高配当株の組み合わせ")
print("  構成: ルネサス 261株 + 日本たばこ 125株")
print("  投資額: 約500万円")
print("  期待リターン: 年率10-12%")
print("  配当: 約22,000円/年 + たばこ製品")
print("  特徴: 成長と配当のバランスが良い")
print("  リスク: 中程度")

print("\n[C] インカム重視型 - 高配当株でシンプルに")
print("  構成: 日本たばこ 125株")
print("  投資額: 50万円")
print("  期待リターン: 年率3-5%（配当）")
print("  配当: 37,500円/年")
print("  特徴: 定期的な高配当が確実。優待も有益")
print("  リスク: 低い")

# ===== 統計分析・総評 =====
print("\n" + "="*100)
print("統計分析・総評")
print("="*100)

print("""
【日本半導体・AI関連銘柄の分析】

1. 東京エレクトロン(8035): 最適なバランス
   - PER 35倍、PBR 8.4倍（高い）
   - 売上・利益ともに成長（2026年予想）
   - AI関連装置の需要で中期成長期待
   - 配当利回り1.4%と低いが、値上がり益が重要
   - 評価: 成長株として有望

2. レーザーテック(6920): 最高成長ポテンシャル
   - PER 42倍、PBR 12.2倍（最も割高）
   - GPU検査装置で超成長中（利益が大きく伸びている）
   - TSMC・Intel・Samsung向けで好調
   - 短期的な成長率は最も高い
   - 評価: 超成長株だが調整リスク注視

3. ソシオネクスト(6526): 割高で注意
   - PER 59倍（最も割高）
   - 利益が減少している（成熟段階）
   - SoC設計で高利益率だが、成長が鈍化
   - 評価: 現在の価格では推奨できない

4. ルネサス(6723): 回復期待のバリュー株
   - PBR 1.6倍（最も割安）
   - 市場調整中だが、通期予想は回復見込み
   - マイコン・メモリで自動車・IoT需要
   - 評価: リスク許容できる投資家向け

【日本高配当・優待株の分析】

配当利回りトップ3:
1. 日本たばこ産業(2914): 7.5%（最高）- 安定配当
2. 三井住友FG(8316): 4.5% - メガバンク
3. JFE鋼鉄(5411): 4.2% - 景気敏感だが高利回り

優待が充実している銘柄:
- ブリヂストン: タイヤ割引サービス
- NTTドコモ・KDDI: 通信割引
- 日本たばこ: たばこ製品・商品券

【投資判断の結論】

1. 現状の評価(2025年11月):
   - 半導体セクター: バリュエーション高い
   - 高配当株: バリュエーション中程度～割高

2. 推奨投資戦略:
   a) NISA月10万円の活用:
      - 半導体: 月4-5万円（成長志向）
      - 高配当: 月5-6万円（安定志向）
      - バランス投資で両セクター確保

   b) 優先順位:
      1. 緊急資金（300万円）確保が最優先
      2. 教育費（2,400万円）達成まではハイリスク投資禁止
      3. 現状の月12.3万円投資を継続

3. 具体的な銘柄選定:
   推奨: 東京エレクトロン(成長) + 日本たばこ(配当)
   理由: バランスが良く、リスク分散できる

4. 注意事項:
   - 半導体セクターのPER/PBRが高いので調整リスク有り
   - 金利上昇は高配当株の魅力減少につながる
   - 市場タイミングを狙わず、毎月コンスタントに投資
""")

print("\n" + "="*100)
print("分析完了 - 2025年11月1日")
print("="*100)
